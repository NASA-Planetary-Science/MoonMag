<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MoonMag &mdash; MoonMag v1.6.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
    <link rel="shortcut icon" href="_static/MoonMag_icon.ico"/>
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=f149d0f4"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="MoonMag documentation" href="pythonModules.html" />
    <link rel="prev" title="MoonMag documentation" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #2980B9" >

          
          
          <a href="index.html">
            
              <img src="_static/MoonMag_logoDocs.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">README</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#magnetic-induction-calculations-and-analysis-for-sounding-of-icy-moons">Magnetic induction calculations and analysis for sounding of icy moons</a></li>
<li class="toctree-l2"><a class="reference internal" href="#acknowledging-moonmag">Acknowledging MoonMag</a></li>
<li class="toctree-l2"><a class="reference internal" href="#quick-start">Quick start</a></li>
<li class="toctree-l2"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="#editing-interior-models">Editing interior models</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#creating-asymmetric-shape-files">Creating asymmetric shape files</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="pythonModules.html">MoonMag documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #2980B9" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MoonMag</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">MoonMag</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/readme.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="moonmag">
<h1>MoonMag<a class="headerlink" href="#moonmag" title="Permalink to this heading"></a></h1>
<p><img alt="MoonMag logo" src="_images/MoonMag_logoDocs.png" /></p>
<section id="magnetic-induction-calculations-and-analysis-for-sounding-of-icy-moons">
<h2>Magnetic induction calculations and analysis for sounding of icy moons<a class="headerlink" href="#magnetic-induction-calculations-and-analysis-for-sounding-of-icy-moons" title="Permalink to this heading"></a></h2>
<p>Written in Python 3.8 as supplemental material for “An analytic solution for evaluating the magnetic field induced from an arbitrary, asymmetric ocean world” DOI: <a class="reference external" href="https://doi.org/10.1016/j.icarus.2021.114840">10.1016/j.icarus.2021.114840</a>. For help, please contact M. Styczinski at itsmoosh&#64;gmail.com.</p>
<p>The main repository is mirrored at <a class="reference external" href="https://github.com/NASA-Planetary-Science/MoonMag">https://github.com/NASA-Planetary-Science/MoonMag</a>; any pull requests should be submitted to <a class="reference external" href="https://github.com/itsmoosh/MoonMag">https://github.com/itsmoosh/MoonMag</a>. Read the software documentation at <a class="reference external" href="https://itsmoosh.github.io/MoonMag">https://itsmoosh.github.io/MoonMag</a>.</p>
</section>
<section id="acknowledging-moonmag">
<h2>Acknowledging MoonMag<a class="headerlink" href="#acknowledging-moonmag" title="Permalink to this heading"></a></h2>
<p>Thank you for your interest in MoonMag! Please consider alerting us to your work (marshall.styczinski&#64;bmsis.org). Suggested acknowledgement in publications: “Data used in this work were generated with the open source MoonMag framework hosted on GitHub.”</p>
</section>
<section id="quick-start">
<h2>Quick start<a class="headerlink" href="#quick-start" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>Run the file <code class="docutils literal notranslate"><span class="pre">runMoonMag.py</span></code> using a Python 3 interpreter.</p></li>
</ul>
<p>You will need the following Python modules:</p>
<ul class="simple">
<li><p>numpy</p></li>
<li><p>matplotlib</p></li>
<li><p>mpmath</p></li>
<li><p>scipy
A working version of LaTeX is needed for optimal plot rendering. If you have LaTeX installed, toggle it on by setting <code class="docutils literal notranslate"><span class="pre">use_latex</span> <span class="pre">=</span> <span class="pre">True</span></code> in <code class="docutils literal notranslate"><span class="pre">config.py</span></code>.</p></li>
</ul>
<p>Parallelization is done through the multiprocessing builtin module, and does not function consistently on all systems. If you encounter errors, try to set do_parallel = False in config.py.</p>
<p>Optional – for trajectory analysis, you will need:</p>
<ul class="simple">
<li><p>The spiceypy Python module, installed using conda install -c conda-forge spiceypy</p></li>
<li><p>Generic and SPK SPICE kernels available from NAIF. See trajec_analysis.py for the expected kernels.</p></li>
<li><p>Trajectory measurement files in System III or moon-specific IAU coordinates.
Run trajectory analysis routines with <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">trajec_analysis.py</span></code>. Note that this feature is a work in progress.</p></li>
</ul>
<p>To generate contour plots showing the asymmetric layer geometry, you will need to edit line 23 in <code class="docutils literal notranslate"><span class="pre">run_all.py</span></code>. These plots take a long time to generate, so they are turned off by default. Animations are set to plot differences in the magnitudes by default. Change this by setting <code class="docutils literal notranslate"><span class="pre">gif_comp</span> <span class="pre">=</span> <span class="pre">&quot;x&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;y&quot;</span></code>, or <code class="docutils literal notranslate"><span class="pre">&quot;z&quot;</span></code> at line 19 in the same file.</p>
</section>
<section id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this heading"></a></h2>
<p>Run settings are split between <code class="docutils literal notranslate"><span class="pre">run_all.py</span></code>, <code class="docutils literal notranslate"><span class="pre">config.py</span></code>, <code class="docutils literal notranslate"><span class="pre">eval_induced_field.py</span></code>, and <code class="docutils literal notranslate"><span class="pre">plotting_funcs.py</span></code>.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">run_all.py</span></code>: Set which bodies to run, whether to plot animation frames, etc.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">config.py</span></code>: Set plot resolutions, precision for calculations, altitudes for magnetic field maps, date/time for evaluation, etc. A toggle for printing induced moments in the Schmidt normalization is also found here.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">eval_induced_field.py</span></code>: Set body radii, maximum shape harmonic degree p, and other normalizations.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">plotting_funcs.py</span></code>: Plot labels, image types, and contour/colormap settings are found within individual plotting functions.</p></li>
</ul>
</section>
<section id="editing-interior-models">
<h2>Editing interior models<a class="headerlink" href="#editing-interior-models" title="Permalink to this heading"></a></h2>
<p>Interior models are generated using <a class="reference external" href="https://github.com/vancesteven/PlanetProfile">PlanetProfile</a>. The specific PlanetProfile run files (called <code class="docutils literal notranslate"><span class="pre">PP&lt;Body&gt;_asymmetry.m</span></code>) used to create the interior conductivity profiles used in this work are contained in the <code class="docutils literal notranslate"><span class="pre">interior/PP_models/</span></code> directory. A modified version of the main PlanetProfile function is contained in <code class="docutils literal notranslate"><span class="pre">interior/PP_models/PlanetProfile_snapshot.m</span></code>. A future version of PlanetProfile will incorporate the changes contained in this file, which are primarily to interpolate the detailed ocean conductivity profile down to just 3 layers (and condense nonconducting layers).</p>
<p>To create a conductivity profile, run a <code class="docutils literal notranslate"><span class="pre">PP&lt;Body&gt;_asymmetry.m</span></code> file from the appropriate (<code class="docutils literal notranslate"><span class="pre">&lt;Body&gt;/</span></code>) directory in your PlanetProfile installation, with <code class="docutils literal notranslate"><span class="pre">PlanetProfile_snapshot.m</span></code> replacing the main <code class="docutils literal notranslate"><span class="pre">PlanetProfile.m</span></code> file. Then, edit the final value in each row of the printed file <code class="docutils literal notranslate"><span class="pre">interior_model_asym_&lt;Body&gt;.txt</span></code> to match the desired asymmetry. These values are ε<sub>l</sub>/r̅<sub>l</sub> as discussed in Section 4.1.2 of the paper. Last, move the edited file to the <code class="docutils literal notranslate"><span class="pre">interior/</span></code> directory here.</p>
<section id="creating-asymmetric-shape-files">
<h3>Creating asymmetric shape files<a class="headerlink" href="#creating-asymmetric-shape-files" title="Permalink to this heading"></a></h3>
<ol class="arabic simple">
<li><p>Collect real-valued, 4π-normalized harmonic coefficients into a single file in interior/ named <code class="docutils literal notranslate"><span class="pre">depth_chi_pq_shape_&lt;Body&gt;.txt</span></code>.</p>
<ul class="simple">
<li><p>See the corresponding file for Miranda for an example. These values are assumed to be layer thicknesses, i.e. depths from the surface to the top of an ocean.</p></li>
<li><p>The default settings in <code class="docutils literal notranslate"><span class="pre">eval_induced_field.py</span></code> apply these coefficients to the layer with index <code class="docutils literal notranslate"><span class="pre">r_io</span></code>, which is negative. For bodies with no ionosphere, typically <code class="docutils literal notranslate"><span class="pre">r_io</span></code> is -2, the second-to-top layer.</p></li>
</ul>
</li>
<li><p>In config.py, set <code class="docutils literal notranslate"><span class="pre">relative</span> <span class="pre">=</span> <span class="pre">False</span></code> and <code class="docutils literal notranslate"><span class="pre">convert_depth_to_chipq</span> <span class="pre">=</span> <span class="pre">True</span></code> and run a field calculation (e.g. <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">run_all.py</span></code> at the terminal). This prints a new file, <code class="docutils literal notranslate"><span class="pre">interior/chi_pq_&lt;Body&gt;.txt</span></code>.</p>
<ul class="simple">
<li><p>The results of this calculation will only apply asymmetry to the layer corresponding to <code class="docutils literal notranslate"><span class="pre">r_io</span></code>.</p></li>
</ul>
</li>
<li><p>Open the new file and the corresponding <code class="docutils literal notranslate"><span class="pre">interior_model_asym_&lt;Body&gt;.txt</span></code> file. For each concentric ocean layer, set the ε<sub>l</sub>/r̅<sub>l</sub> values to be the bcdev value reported at the end of the header line of <code class="docutils literal notranslate"><span class="pre">chi_pq_&lt;Body&gt;.txt</span></code> divided by the radius of the layer corresponding to <code class="docutils literal notranslate"><span class="pre">r_io</span></code>.</p>
<ul class="simple">
<li><p>For example, for Miranda <code class="docutils literal notranslate"><span class="pre">bcdev</span> <span class="pre">=</span> <span class="pre">39120.39</span> <span class="pre">m</span></code> and <code class="docutils literal notranslate"><span class="pre">r_io</span> <span class="pre">=</span> <span class="pre">-3</span></code> as it has an ionosphere. The radius of that boundary is 185989.764 m, so the ε<sub>l</sub>/r̅<sub>l</sub> value to use is 39120.39 / 185989.764 = 0.21. Each layer should have the same value here if they are concentric–the absolute asymmetry is scaled to the radius of the boundary.</p></li>
</ul>
</li>
<li><p>For each degree p up to the desired pmax, create a file in <code class="docutils literal notranslate"><span class="pre">interior/</span></code> named <code class="docutils literal notranslate"><span class="pre">degree&lt;p&gt;_shapes_&lt;Body&gt;.txt</span></code> and add a single descriptive header line to each.</p>
<ul class="simple">
<li><p>See the corresponding Miranda files for examples.</p></li>
</ul>
</li>
<li><p>Copy the lines of the <code class="docutils literal notranslate"><span class="pre">chi_pq_&lt;Body&gt;.txt</span></code> file for each harmonic <em>multiple times</em> into the corresponding <code class="docutils literal notranslate"><span class="pre">degree&lt;p&gt;_shapes</span></code> files, with one line for each layer in <code class="docutils literal notranslate"><span class="pre">interior_model_asym_&lt;Body&gt;.txt</span></code>.</p>
<ul class="simple">
<li><p>If desired, these coefficients (the χ<sup>l</sup><sub>pq</sub> values) may be adjusted to specify asymmetric layers independently.</p></li>
</ul>
</li>
<li><p>In <code class="docutils literal notranslate"><span class="pre">config.py</span></code>, set <code class="docutils literal notranslate"><span class="pre">relative</span> <span class="pre">=</span> <span class="pre">True</span></code>. Executing <code class="docutils literal notranslate"><span class="pre">run_all.py</span></code> will now use the values in <code class="docutils literal notranslate"><span class="pre">degree&lt;p&gt;_shapes</span></code> and <code class="docutils literal notranslate"><span class="pre">interior_model_asym</span></code> files to set the asymmetry for each layer.</p></li>
</ol>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="MoonMag documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="pythonModules.html" class="btn btn-neutral float-right" title="MoonMag documentation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Marshall J. Styczinski.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>